import streamlit as st
import random

# --- æ¸¸æˆåˆå§‹åŒ– ---
# st.session_state æ˜¯Streamlitæä¾›çš„â€œä¼šè¯çŠ¶æ€â€å¯¹è±¡ï¼Œç”¨æ¥åœ¨å¤šæ¬¡äº¤äº’ä¹‹é—´ä¿å­˜å˜é‡ã€‚
# æˆ‘ä»¬ç”¨å®ƒæ¥å­˜å‚¨ secret_numberï¼Œç¡®ä¿å®ƒåœ¨æ•´ä¸ªæ¸¸æˆä¼šè¯ä¸­ä¿æŒä¸å˜ã€‚

# æ£€æŸ¥ 'secret_number' æ˜¯å¦å·²ç»å­˜åœ¨äº session_state ä¸­
# å¦‚æœä¸å­˜åœ¨ï¼Œè¯´æ˜æ˜¯æ¸¸æˆåˆšå¼€å§‹ï¼Œæˆ‘ä»¬éœ€è¦ç”Ÿæˆä¸€ä¸ªæ–°çš„ç§˜å¯†æ•°å­—
if 'secret_number' not in st.session_state:
    st.session_state.secret_number = random.randint(1, 100)

# --- ç½‘é¡µç•Œé¢å¸ƒå±€ ---

# 1. æ˜¾ç¤ºæ ‡é¢˜å’Œæ¸¸æˆè¯´æ˜
st.title(" çŒœæ•°å­—æ¸¸æˆ ğŸ®")
st.write("æˆ‘å¿ƒé‡Œæƒ³å¥½äº†ä¸€ä¸ª 1 åˆ° 100 ä¹‹é—´çš„æ•°å­—ï¼Œä½ æ¥çŒœçŒœçœ‹å§ï¼")

# 2. åˆ›å»ºä¸€ä¸ªæ•°å­—è¾“å…¥æ¡†ï¼Œè®©ç”¨æˆ·è¾“å…¥çŒœæµ‹çš„æ•°å­—
# ä½¿ç”¨ st.number_input å¯ä»¥ç¡®ä¿ç”¨æˆ·è¾“å…¥çš„æ˜¯æ•°å­—
# step=1 è¡¨ç¤ºæ¯æ¬¡ç‚¹å‡»åŠ å‡å·ï¼Œæ•°å­—å˜åŒ–1
# value=None è®©è¾“å…¥æ¡†é»˜è®¤ä¸ºç©º
guess = st.number_input("è¯·è¾“å…¥ä½ çŒœçš„æ•°å­—:", min_value=1, max_value=100, step=1, value=None)

# 3. åˆ›å»ºä¸€ä¸ªâ€œçŒœï¼â€æŒ‰é’®
# æˆ‘ä»¬æŠŠä¸»è¦çš„æ¸¸æˆåˆ¤æ–­é€»è¾‘æ”¾åœ¨è¿™ä¸ª if è¯­å¥å—é‡Œ
# åªæœ‰å½“ç”¨æˆ·ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œæ‰ä¼šæ‰§è¡Œåˆ¤æ–­
if st.button("çŒœï¼"):
    # æ£€æŸ¥ç”¨æˆ·æ˜¯å¦è¾“å…¥äº†æ•°å­—
    if guess is None:
        st.warning("ä½ è¿˜æ²¡æœ‰è¾“å…¥æ•°å­—å“¦ï¼")
    else:
        # è·å–å­˜å‚¨åœ¨ session_state ä¸­çš„ç§˜å¯†æ•°å­—
        secret_number = st.session_state.secret_number
        
        # --- æ ¸å¿ƒåˆ¤æ–­é€»è¾‘ ---
        if guess < secret_number:
            st.info("å¤ªå°äº†ï¼Œå†å¾€å¤§ç‚¹çŒœï¼") # st.info() æ˜¾ç¤ºä¸€ä¸ªè“è‰²çš„æç¤ºæ¡†
        elif guess > secret_number:
            st.info("å¤ªå¤§äº†ï¼Œå†å¾€å°ç‚¹çŒœï¼")
        else:
            st.success(f"ğŸ‰ æ­å–œä½ ï¼çŒœå¯¹äº†ï¼å°±æ˜¯æ•°å­— {secret_number}ï¼ğŸ‰")
            st.balloons() # çŒœå¯¹äº†ï¼Œæ”¾ç‚¹æ°”çƒåº†ç¥ä¸€ä¸‹ï¼
            
            # æ¸¸æˆç»“æŸåï¼Œå¯ä»¥é‡ç½®ç§˜å¯†æ•°å­—ï¼Œä»¥ä¾¿å¼€å§‹æ–°ä¸€è½®æ¸¸æˆ
            # è¿™é‡Œæˆ‘ä»¬é€šè¿‡åˆ é™¤ session_state ä¸­çš„ key æ¥å®ç°
            del st.session_state.secret_number
            st.write("æˆ‘å·²ç»æƒ³å¥½äº†ä¸‹ä¸€ä¸ªæ•°å­—ï¼Œåˆ·æ–°é¡µé¢æˆ–è€…å†æ¬¡è¾“å…¥æ¥å¼€å§‹æ–°æ¸¸æˆå§ï¼")

# ä¸ºäº†å¢åŠ è¶£å‘³æ€§ï¼Œå¯ä»¥æ·»åŠ ä¸€ä¸ªâ€œé‡ç½®æ¸¸æˆâ€çš„æŒ‰é’®
if st.button("é‡ç½®æ¸¸æˆå¹¶æ¢ä¸ªæ•°å­—"):
    st.session_state.secret_number = random.randint(1, 100)
    st.rerun() # ç«‹å³é‡æ–°è¿è¡Œæ•´ä¸ªè„šæœ¬ï¼Œåˆ·æ–°ç•Œé¢